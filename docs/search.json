[{"path":"/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 Brad Blaser Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Brad Blaser. Author, maintainer.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Blaser B (2025). saber: Selecting Amplicon Barcodes Experimental Replicates. R package version 0.0.0.9007, https://github.com/blaserlab/saber.","code":"@Manual{,   title = {saber: Selecting Amplicon Barcodes from Experimental Replicates},   author = {Brad Blaser},   year = {2025},   note = {R package version 0.0.0.9007},   url = {https://github.com/blaserlab/saber}, }"},{"path":"/index.html","id":"selecting-amplicon-barcodes-using-experimental-replicates","dir":"","previous_headings":"","what":"Selecting Amplicon Barcodes from Experimental Replicates","title":"Selecting Amplicon Barcodes from Experimental Replicates","text":"saber package provides functions genotyping GESTALT barcodes, barcode quality control, quantifying barcodes experiment dozens samples . updated/modernized version code published Teets, E.M., et al., Quantifying Hematopoietic Stem Cell Clonal Diversity Selecting Informative Amplicon Barcodes. Sci Rep, 2020. 10(1): p. 2153. Currently GESTALT genotyping function implemented package.","code":""},{"path":"/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Selecting Amplicon Barcodes from Experimental Replicates","text":"can install saber like :","code":"pak::pkg_install(\"blaserlab/saber\")"},{"path":"/index.html","id":"genotyping-bulk-gestalt-amplicon-data","dir":"","previous_headings":"","what":"Genotyping Bulk Gestalt Amplicon Data","title":"Selecting Amplicon Barcodes from Experimental Replicates","text":"need generate configuration file csv format. Columns : group can identify experimental group “not_applicable”, must character string. “samples_fp_1” “samples_fp_2” file paths R1 R2 fastq files sample. blank config file can found running: run:","code":"sample,group,sample_fp_1,sample_fp_2 fs::path_package(package = \"saber\", \"extdata\", \"gestalt_config.csv\") library(saber)  gestalt_typing(config = \"<path/to/config/file>\", output_folder = \"<path/to/output>\")"},{"path":"/reference/Saber.html","id":null,"dir":"Reference","previous_headings":"","what":"Saber class for filtered CRISPR barcode analyses — Saber","title":"Saber class for filtered CRISPR barcode analyses — Saber","text":"Saber class S7 object encapsulates results CRISPR barcode filtering quality control, including filtered variant count matrix, recurrent (stereotyped) variants, per-sample per-variant QC summaries, thresholds/parameters used construct object.","code":""},{"path":"/reference/Saber.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Saber class for filtered CRISPR barcode analyses — Saber","text":"","code":"Saber(   description = character(0),   filtered_counts = NULL,   recurrent_variants = NULL,   motif_blacklist = character(0),   per_sample_uniques = NULL,   per_sample_qc = NULL,   per_variant_qc = NULL,   thresholds = list() )"},{"path":"/reference/Saber.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Saber class for filtered CRISPR barcode analyses — Saber","text":"Objects class Saber typically constructed via make.Saber(), performs empirical threshold estimation, permutation-based detection recurrent stereotyped variants, downstream QC summarization. class defined following properties: description Character scalar describing dataset analysis. filtered_counts Matrix variant counts stereotyped junk \"variant\" rows removed (variants x samples). recurrent_variants Tibble/data frame per-variant recurrence entropy metrics, including flags recurrent stereotyped variants \"variant\" rows. motif_blacklist Character vector variant identifiers treated uninformative (either recurrent stereotyped variants \"variant\" background). per_sample_uniques Tibble/data frame summarizing per-sample counts unique informative barcodes. per_sample_qc Tibble/data frame per-sample QC metrics, including total reads, fractions kept/recurrent/-variant reads, sample entropy filtering. per_variant_qc Tibble/data frame per-variant collision probabilities related metrics. thresholds List thresholds analysis parameters used construct object (e.g., count/VAF thresholds, minimum sample depth, permutation settings). validator checks filtered_counts matrix recurrent_variants, per_sample_uniques, per_sample_qc, per_variant_qc tibbles (\"tbl_df\").","code":""},{"path":[]},{"path":"/reference/barcodes.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract filtered barcode count matrix from a Saber object — barcodes","title":"Extract filtered barcode count matrix from a Saber object — barcodes","text":"Generic accessor retrieving filtered barcode count matrix (variants x samples) Saber object. Saber, returns @filtered_counts slot.","code":""},{"path":"/reference/barcodes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract filtered barcode count matrix from a Saber object — barcodes","text":"","code":"barcodes(x, ...)"},{"path":"/reference/barcodes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract filtered barcode count matrix from a Saber object — barcodes","text":"x Saber object.","code":""},{"path":"/reference/barcodes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract filtered barcode count matrix from a Saber object — barcodes","text":"Saber object, numeric matrix filtered barcode counts stereotyped junk \"variant\" rows removed.","code":""},{"path":[]},{"path":"/reference/blacklist.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract motif/variant blacklist from a Saber object — blacklist","title":"Extract motif/variant blacklist from a Saber object — blacklist","text":"Generic accessor retrieving blacklist uninformative barcodes (variants) Saber object. Saber, returns @motif_blacklist slot.","code":""},{"path":"/reference/blacklist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract motif/variant blacklist from a Saber object — blacklist","text":"","code":"blacklist(x, ...)"},{"path":"/reference/blacklist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract motif/variant blacklist from a Saber object — blacklist","text":"x Saber object.","code":""},{"path":"/reference/blacklist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract motif/variant blacklist from a Saber object — blacklist","text":"Saber object, character vector variant IDs corresponding stereotyped recurrent /\"variant\" motifs treated background.","code":""},{"path":[]},{"path":"/reference/col_entropy_normalized.html","id":null,"dir":"Reference","previous_headings":"","what":"Column-wise normalized entropy (sample-level) — col_entropy_normalized","title":"Column-wise normalized entropy (sample-level) — col_entropy_normalized","text":"Compute normalized Shannon entropy numeric vector, typically representing counts variants within single sample. Entropy computed non-zero entries normalized \\([0, 1]\\).","code":""},{"path":"/reference/col_entropy_normalized.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Column-wise normalized entropy (sample-level) — col_entropy_normalized","text":"","code":"col_entropy_normalized(x)"},{"path":"/reference/col_entropy_normalized.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Column-wise normalized entropy (sample-level) — col_entropy_normalized","text":"x Numeric vector counts variants one sample.","code":""},{"path":"/reference/col_entropy_normalized.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Column-wise normalized entropy (sample-level) — col_entropy_normalized","text":"single numeric scalar \\([0, 1]\\) giving normalized entropy.","code":""},{"path":"/reference/col_entropy_normalized.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Column-wise normalized entropy (sample-level) — col_entropy_normalized","text":"helper used internally summarize per-sample diversity barcodes filtering stereotyped recurrent variants.","code":""},{"path":"/reference/cross_sabers.html","id":null,"dir":"Reference","previous_headings":"","what":"Cross-link barcoded samples across multiple Saber objects — cross_sabers","title":"Cross-link barcoded samples across multiple Saber objects — cross_sabers","text":"Use shared top-n barcodes link samples across groups Saber objects, typically representing different experimental runs time points set animals (e.g., zebrafish). first element saber_list treated reference group, samples subsequent groups matched reference overlapping top barcodes.","code":""},{"path":"/reference/cross_sabers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cross-link barcoded samples across multiple Saber objects — cross_sabers","text":"","code":"cross_sabers(saber_list, n_top = 10L, min_match_score = 5L)"},{"path":"/reference/cross_sabers.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cross-link barcoded samples across multiple Saber objects — cross_sabers","text":"saber_list named list Saber objects. names list used group identifiers. n_top Integer scalar; number top barcodes per sample (per group) consider computing matches. Defaults 10. min_match_score Integer scalar; minimum number shared top barcodes required call match sample reference sample. Defaults 5.","code":""},{"path":"/reference/cross_sabers.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cross-link barcoded samples across multiple Saber objects — cross_sabers","text":"Invisibly, function either: raises error samples match one reference, (integrated workflow) yields tibble matches last evaluated expression consistency check. tibble contains group, sample_name, true_id (reference sample), top_* columns, match_score.","code":""},{"path":"/reference/cross_sabers.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Cross-link barcoded samples across multiple Saber objects — cross_sabers","text":"Saber object, function: Extracts filtered count matrix via barcodes(). Uses top_n_rownames_by_column() identify top n_top barcodes per sample. Adds group column indicating originating list element. groups combined passed rec_name(), recursively matches samples first group's samples (reference) using number shared top barcodes score. matching, check performed ensure sample matched one reference sample; condition violated, error raised suggesting increasing stringency improving barcode filtering.","code":""},{"path":[]},{"path":"/reference/estimate_barcode_collision_probs.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate per-variant barcode collision probabilities — estimate_barcode_collision_probs","title":"Estimate per-variant barcode collision probabilities — estimate_barcode_collision_probs","text":"Estimate, variant, probability arises multiple times independently single sample simple Poisson model, using observed sharing variant across samples.","code":""},{"path":"/reference/estimate_barcode_collision_probs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate per-variant barcode collision probabilities — estimate_barcode_collision_probs","text":"","code":"estimate_barcode_collision_probs(count_mat, count_thresh, freq_thresh)"},{"path":"/reference/estimate_barcode_collision_probs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate per-variant barcode collision probabilities — estimate_barcode_collision_probs","text":"count_mat Numeric matrix variant counts (rows = variants, columns = samples). count_thresh Integer minimum count threshold presence, used construct presence matrix. freq_thresh Numeric minimum VAF threshold presence, used construct presence matrix.","code":""},{"path":"/reference/estimate_barcode_collision_probs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate per-variant barcode collision probabilities — estimate_barcode_collision_probs","text":"tibble one row per variant containing: variant Variant identifier. n_samples_present Number samples variant present. p_sample_present Estimated probability random sample contains variant least . lambda_per_sample Estimated Poisson mean per sample. P_ge2_per_sample Unconditional probability \\(P(K \\ge 2)\\). P_ge2_given_present Conditional probability \\(P(K \\ge 2 \\mid K \\ge 1)\\).","code":""},{"path":"/reference/estimate_barcode_collision_probs.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate per-variant barcode collision probabilities — estimate_barcode_collision_probs","text":"logical presence matrix first constructed using generate_present_mat(). variant \\(\\), number samples present \\(m_i\\) used estimate \\(\\hat{p}_i = m_i / S\\), \\(S\\) number samples. Poisson model number independent origins per sample, \\(K_i \\sim \\mathrm{Poisson}(\\lambda_i)\\), \\(\\hat{p}_i \\approx P(K_i \\ge 1) = 1 - e^{-\\lambda_i}\\), \\(\\hat{\\lambda}_i = -\\log(1 - \\hat{p}_i)\\). , P_ge2_per_sample P_ge2_given_present computed.","code":""},{"path":"/reference/estimate_barcode_thresholds.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate empirical count and VAF thresholds from noise — estimate_barcode_thresholds","title":"Estimate empirical count and VAF thresholds from noise — estimate_barcode_thresholds","text":"Estimate count variant allele frequency (VAF) thresholds defining barcode presence based empirical distribution low-prevalence variants (noise) across count matrix.","code":""},{"path":"/reference/estimate_barcode_thresholds.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate empirical count and VAF thresholds from noise — estimate_barcode_thresholds","text":"","code":"estimate_barcode_thresholds(   count_mat,   depths = NULL,   no_variant_pattern = \"^no variant$\",   background = c(\"singletons\", \"all\"),   noise_quantile = 0.99 )"},{"path":"/reference/estimate_barcode_thresholds.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate empirical count and VAF thresholds from noise — estimate_barcode_thresholds","text":"count_mat Numeric matrix variant counts (rows = variants, columns = samples). depths Optional numeric vector per-sample depths (column sums). NULL, computed colSums(count_mat) excluding rows matching no_variant_pattern. no_variant_pattern Character scalar, regular expression matching rows represent \"variant\" background excluded noise estimation. background Character scalar specifying cells treat background estimating thresholds. Either \"singletons\" (variants present exactly one sample) \"\" (non-zero entries). noise_quantile Numeric scalar \\((0, 1)\\) giving quantile empirical count VAF distributions treat upper bound noise. Values just quantile used thresholds.","code":""},{"path":"/reference/estimate_barcode_thresholds.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate empirical count and VAF thresholds from noise — estimate_barcode_thresholds","text":"list elements: count_thresh Integer count threshold presence. freq_thresh Numeric VAF threshold presence. noise_quantile noise quantile used. background background mode used. n_nonzero_used Number non-zero observations used estimate thresholds.","code":""},{"path":"/reference/estimate_barcode_thresholds.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate empirical count and VAF thresholds from noise — estimate_barcode_thresholds","text":"function: Excludes rows matching no_variant_pattern. Optionally restricts \"singleton\" variants (present exactly one sample) background = \"singletons\". Computes specified noise_quantile empirical non-zero counts VAFs sets count_thresh one plus floored count quantile freq_thresh VAF quantile.","code":""},{"path":"/reference/generate_present_mat.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a logical presence matrix from counts and thresholds — generate_present_mat","title":"Generate a logical presence matrix from counts and thresholds — generate_present_mat","text":"Create logical matrix indicating presence/absence variants samples based count VAF thresholds.","code":""},{"path":"/reference/generate_present_mat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a logical presence matrix from counts and thresholds — generate_present_mat","text":"","code":"generate_present_mat(count_mat, count_thresh, freq_thresh)"},{"path":"/reference/generate_present_mat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a logical presence matrix from counts and thresholds — generate_present_mat","text":"count_mat Numeric matrix variant counts (rows = variants, columns = samples). count_thresh Integer minimum count threshold presence. freq_thresh Numeric minimum VAF threshold presence.","code":""},{"path":"/reference/generate_present_mat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a logical presence matrix from counts and thresholds — generate_present_mat","text":"logical matrix dimension count_mat TRUE indicating presence.","code":""},{"path":"/reference/generate_present_mat.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate a logical presence matrix from counts and thresholds — generate_present_mat","text":"Variant allele frequencies computed count / depth, depth column sum count_mat. cell considered present count greater equal count_thresh VAF greater equal freq_thresh.","code":""},{"path":"/reference/gestalt_typing.html","id":null,"dir":"Reference","previous_headings":"","what":"Type Gestalt Barcoding DAta — gestalt_typing","title":"Type Gestalt Barcoding DAta — gestalt_typing","text":"Generates typing results specified directory.  time stamp appended directory path provided.","code":""},{"path":"/reference/gestalt_typing.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Type Gestalt Barcoding DAta — gestalt_typing","text":"","code":"gestalt_typing(   output_folder,   config,   multiplex = FALSE,   trimmomatic_path = \"/opt/Trimmomatic-0.39/trimmomatic-0.39.jar\" )"},{"path":"/reference/gestalt_typing.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Type Gestalt Barcoding DAta — gestalt_typing","text":"output_folder Folder output config Config file setting analysis.  See extdata/gestalt_config.csv trimmomatic_path PARAM_DESCRIPTION, Default: '/opt/Trimmomatic-0.39/trimmomatic-0.39.jar'","code":""},{"path":"/reference/gestalt_typing.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Type Gestalt Barcoding DAta — gestalt_typing","text":"return anything","code":""},{"path":"/reference/make.Saber.html","id":null,"dir":"Reference","previous_headings":"","what":"Construct a Saber object from CRISPR barcode data — make.Saber","title":"Construct a Saber object from CRISPR barcode data — make.Saber","text":"Build Saber object CrispRVariants crispr_set estimating empirical noise thresholds, identifying stereotyped recurrent barcode variants using permutation-based test entropy filter, summarizing per-sample per-variant quality metrics.","code":""},{"path":"/reference/make.Saber.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Construct a Saber object from CRISPR barcode data — make.Saber","text":"","code":"make.Saber(   crispr_set,   description = \"No description provided.\",   min_sample_depth = 1000,   background_count = 100,   background_freq = 0.001,   depths = NULL,   no_variant_pattern = \"^no variant$\",   thresholds = NULL,   min_samples = 2L,   alpha = 0.05,   background = c(\"singletons\", \"all\"),   noise_quantile = 0.99,   entropy_thresh = 0.8,   B = 1000L,   seed = NULL,   progress = TRUE )"},{"path":"/reference/make.Saber.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Construct a Saber object from CRISPR barcode data — make.Saber","text":"crispr_set CrispRVariants crisprSet (similar) object variant count matrices can extracted via CrispRVariants::variantCounts(). description Character scalar describing analysis dataset. min_sample_depth Numeric scalar; samples total depth (column sum) value excluded prior analysis. background_count Integer count threshold used computing per-variant collision probabilities (background model). background_freq Numeric VAF threshold used computing per-variant collision probabilities (background model). depths Optional numeric vector per-sample depths. NULL, computed colSums(count_mat). no_variant_pattern Character scalar, regular expression used identify rows corresponding \"variant\" background. thresholds Optional list returned estimate_barcode_thresholds(). NULL, thresholds estimated data (recommended). min_samples Integer; minimum number samples variant must present (thresholding) considered recurrent filtering. alpha Numeric scalar; FDR threshold applied permutation-based empirical p-values calling recurrent variants. background Character scalar specifying define background estimating noise thresholds; either \"singletons\" \"\". noise_quantile Numeric scalar \\((0, 1)\\); quantile empirical count VAF distributions used noise upper bound. entropy_thresh Numeric scalar \\([0, 1]\\); variants normalized entropy greater equal value (.e. evenly distributed across samples) likely treated stereotyped junk also recurrent significant permutation test. B Integer; number permutations used estimate empirical p-values variant recurrence. seed Optional integer random seed passed set.seed() reproducibility permutation procedure. progress Logical; TRUE, progress messages printed permutation loop.","code":""},{"path":"/reference/make.Saber.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Construct a Saber object from CRISPR barcode data — make.Saber","text":"Saber object (S7/R7 class defined elsewhere) containing: description: Analysis description. filtered_counts: Matrix counts stereotyped junk -variant rows removed. recurrent_variants: Data frame per-variant recurrence entropy statistics. motif_blacklist: Character vector variant IDs treated uninformative (recurrent -variant). per_sample_uniques: Data frame unique barcodes per sample. per_sample_qc: Data frame per-sample QC metrics. per_variant_qc: Tibble per-variant collision probabilities based background model. thresholds: List thresholds analysis parameters.","code":""},{"path":"/reference/make.Saber.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Construct a Saber object from CRISPR barcode data — make.Saber","text":"workflow implemented make.Saber() : Extract variant count matrix crispr_set drop samples depth min_sample_depth. Estimate empirical count_thresh freq_thresh using estimate_barcode_thresholds() thresholds NULL. Define variant presence using thresholds, exclude \"variant\" rows. variant, compute number samples present normalized entropy across samples. Perform permutation-based recurrence test shuffling presence matrix within columns B times, deriving empirical p-values FDR-adjusted p-values. Define stereotyped recurrent variants (is_recurrent) () \"variant\", (ii) present least min_samples samples, (iii) significant FDR alpha, (iv) entropy greater equal entropy_thresh. Remove \"variant\" rows recurrent stereotyped variants obtain filtered_counts. Summarize per-sample metrics (total reads, fractions kept, recurrent, -variant reads, unique barcodes, entropy filtering). Compute per-variant collision probabilities filtered matrix using estimate_barcode_collision_probs() background_count background_freq. Construct return Saber object components.","code":""},{"path":[]},{"path":"/reference/plot_saber_sample_qc.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample-level QC plot for a Saber object — plot_saber_sample_qc","title":"Sample-level QC plot for a Saber object — plot_saber_sample_qc","text":"Visualize per-sample quality control metrics, highlighting samples low fraction reads retained filtering recurrent -variant barcodes. Outliers defined samples whose frac_reads_kept least 3 median absolute deviations (MADs) median.","code":""},{"path":"/reference/plot_saber_sample_qc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample-level QC plot for a Saber object — plot_saber_sample_qc","text":"","code":"plot_saber_sample_qc(x)"},{"path":"/reference/plot_saber_sample_qc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample-level QC plot for a Saber object — plot_saber_sample_qc","text":"x Saber object.","code":""},{"path":"/reference/plot_saber_sample_qc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample-level QC plot for a Saber object — plot_saber_sample_qc","text":"ggplot object.","code":""},{"path":"/reference/plot_saber_sample_qc.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Sample-level QC plot for a Saber object — plot_saber_sample_qc","text":"function uses per_sample_qc slot x (via sample_data()) produces bar plot frac_reads_kept per sample, ordered fraction. outlier threshold computed : $$   T = \\mathrm{median}(\\mathrm{frac\\_reads\\_kept}) - 3 \\times \\mathrm{MAD}(\\mathrm{frac\\_reads\\_kept}) $$ using usual MAD definition. Samples frac_reads_kept < T highlighted different color, horizontal dashed line drawn T.","code":""},{"path":[]},{"path":"/reference/plot_saber_variant_collision.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Variant collision risk plot for a Saber object — plot_saber_variant_collision","text":"","code":"plot_saber_variant_collision(x, p_ge2_thresh = 0.05)"},{"path":"/reference/plot_saber_variant_collision.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Variant collision risk plot for a Saber object — plot_saber_variant_collision","text":"x Saber object. p_ge2_thresh Numeric scalar; variants P_ge2_given_present >= p_ge2_thresh highlighted. Defaults 0.05 (5\\ ggplot object.   Visualize per-variant collision probabilities identify barcode variants likely arise independently sample.   function uses per_variant_qc slot x (via variant_data()). primary plot scatter plot n_samples_present (x-axis) versus P_ge2_given_present (y-axis), P_ge2_given_present model-based probability variant arises least twice sample, conditional observed least .horizontal dashed line drawn p_ge2_thresh. Axis limits set observed ranges n_samples_present P_ge2_given_present data points included plotting region.","code":""},{"path":"/reference/plot_saber_variant_entropy.html","id":null,"dir":"Reference","previous_headings":"","what":"Variant recurrence vs entropy diagnostic plot for a Saber object — plot_saber_variant_entropy","title":"Variant recurrence vs entropy diagnostic plot for a Saber object — plot_saber_variant_entropy","text":"Create scatter plot number samples variant observed versus normalized entropy across samples. Variants colored is_recurrent flag, optional threshold lines indicate recurrence entropy cutoffs used calling stereotyped junk.","code":""},{"path":"/reference/plot_saber_variant_entropy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Variant recurrence vs entropy diagnostic plot for a Saber object — plot_saber_variant_entropy","text":"","code":"plot_saber_variant_entropy(x, show_thresholds = TRUE)"},{"path":"/reference/plot_saber_variant_entropy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Variant recurrence vs entropy diagnostic plot for a Saber object — plot_saber_variant_entropy","text":"x Saber object. show_thresholds Logical; TRUE (default), draw vertical horizontal lines min_samples entropy_thresh taken x@thresholds, available.","code":""},{"path":"/reference/plot_saber_variant_entropy.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Variant recurrence vs entropy diagnostic plot for a Saber object — plot_saber_variant_entropy","text":"ggplot object.","code":""},{"path":"/reference/plot_saber_variant_entropy.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Variant recurrence vs entropy diagnostic plot for a Saber object — plot_saber_variant_entropy","text":"plot based recurrent_variants slot x includes variants is_no_variant == FALSE. x-axis number samples variant present (thresholding), y-axis normalized entropy across samples. Variants flagged recurrent stereotyped junk (is_recurrent == TRUE) typically found upper-right region plot.","code":""},{"path":"/reference/print.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for Saber objects — print","title":"Print method for Saber objects — print","text":"simple print method Saber objects displays short summary including description, number samples, number filtered variants.","code":""},{"path":"/reference/print.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for Saber objects — print","text":"x Saber object. ... Additional arguments (currently ignored).","code":""},{"path":"/reference/print.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print method for Saber objects — print","text":"Invisibly returns x.","code":""},{"path":[]},{"path":"/reference/rec_name.html","id":null,"dir":"Reference","previous_headings":"","what":"Recursive matching of samples across groups based on top-n barcodes — rec_name","title":"Recursive matching of samples across groups based on top-n barcodes — rec_name","text":"Internal helper used cross_sabers() recursively link samples across groups shared top-n barcodes. first group input$group treated reference group.","code":""},{"path":"/reference/rec_name.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Recursive matching of samples across groups based on top-n barcodes — rec_name","text":"","code":"rec_name(input, group_order, current_idx, n_top, min_match_score)"},{"path":"/reference/rec_name.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Recursive matching of samples across groups based on top-n barcodes — rec_name","text":"input Tibble/data frame containing least group column, sample_name column, set top_* columns produced top_n_rownames_by_column(). n_top Integer scalar; number top_* columns used (passed cross_sabers()). min_match_score Integer scalar; minimum number shared top barcodes required call match (passed cross_sabers()).","code":""},{"path":"/reference/rec_name.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Recursive matching of samples across groups based on top-n barcodes — rec_name","text":"tibble matched samples, one rows per sample depending ties, including sample_name, first_name (reference ID), top_* columns, match_score.","code":""},{"path":"/reference/rec_name.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Recursive matching of samples across groups based on top-n barcodes — rec_name","text":"function: Identifies first group data reference group. Builds table reference samples top_* barcodes. Performs cross join samples reference samples, computing, pair, number shared non-NA top_* barcodes (match_score). sample, retains reference maximum match_score, filters matches min_match_score. Removes matched samples recurses remaining input unmatched samples remain.","code":""},{"path":"/reference/row_entropy_normalized.html","id":null,"dir":"Reference","previous_headings":"","what":"Row-wise normalized entropy (variant-level) — row_entropy_normalized","title":"Row-wise normalized entropy (variant-level) — row_entropy_normalized","text":"Compute normalized Shannon entropy numeric vector, typically representing counts single variant across samples. Entropy computed non-zero entries normalized lie \\([0, 1]\\) dividing \\(\\log(m)\\), \\(m\\) number non-zero entries.","code":""},{"path":"/reference/row_entropy_normalized.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Row-wise normalized entropy (variant-level) — row_entropy_normalized","text":"","code":"row_entropy_normalized(x)"},{"path":"/reference/row_entropy_normalized.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Row-wise normalized entropy (variant-level) — row_entropy_normalized","text":"x Numeric vector counts single variant across samples.","code":""},{"path":"/reference/row_entropy_normalized.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Row-wise normalized entropy (variant-level) — row_entropy_normalized","text":"single numeric scalar \\([0, 1]\\) giving normalized entropy.","code":""},{"path":"/reference/row_entropy_normalized.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Row-wise normalized entropy (variant-level) — row_entropy_normalized","text":"helper intended internal use quantifying evenly given barcode/variant distributed across samples. Values near 0 indicate counts concentrated single sample (clone-like), whereas values near 1 indicate counts spread evenly across many samples (stereotyped motif-like).","code":""},{"path":"/reference/sample_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract per-sample QC data from a Saber object — sample_data","title":"Extract per-sample QC data from a Saber object — sample_data","text":"Generic accessor retrieving sample-level quality control metrics Saber object. Saber, returns @per_sample_qc slot.","code":""},{"path":"/reference/sample_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract per-sample QC data from a Saber object — sample_data","text":"","code":"sample_data(x, ...)"},{"path":"/reference/sample_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract per-sample QC data from a Saber object — sample_data","text":"x Saber object.","code":""},{"path":"/reference/sample_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract per-sample QC data from a Saber object — sample_data","text":"Saber object, tibble/data frame per-sample QC metrics, including total reads, fractions reads kept/recurrent/ -variant categories, unique barcodes, entropy /filtering.","code":""},{"path":[]},{"path":"/reference/top_n_rownames_by_column.html","id":null,"dir":"Reference","previous_headings":"","what":"Identify top-n variants per sample — top_n_rownames_by_column","title":"Identify top-n variants per sample — top_n_rownames_by_column","text":"column (sample) numeric matrix, return row names corresponding top n values. result tibble one row per sample columns top_1, top_2, ..., top_n.","code":""},{"path":"/reference/top_n_rownames_by_column.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identify top-n variants per sample — top_n_rownames_by_column","text":"","code":"top_n_rownames_by_column(mat, n)"},{"path":"/reference/top_n_rownames_by_column.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identify top-n variants per sample — top_n_rownames_by_column","text":"mat Numeric matrix values (rows = variants, columns = samples). n Integer scalar; number top variants select per sample.","code":""},{"path":"/reference/top_n_rownames_by_column.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identify top-n variants per sample — top_n_rownames_by_column","text":"tibble one row per sample, sample_name column, top_1 top_n columns containing variant IDs.","code":""},{"path":"/reference/top_n_rownames_by_column.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Identify top-n variants per sample — top_n_rownames_by_column","text":"row names missing, created character indices (\"1\", \"2\", ...). column names missing, created \"col1\", \"col2\", etc. sample, row names top n entries returned descending order column values. sample fewer n non-NA entries, remaining positions padded NA.","code":""},{"path":"/reference/variant_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract per-variant QC data from a Saber object — variant_data","title":"Extract per-variant QC data from a Saber object — variant_data","text":"Generic accessor retrieving variant-level QC statistics Saber object. Saber, returns @per_variant_qc slot.","code":""},{"path":"/reference/variant_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract per-variant QC data from a Saber object — variant_data","text":"","code":"variant_data(x, ...)"},{"path":"/reference/variant_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract per-variant QC data from a Saber object — variant_data","text":"x Saber object.","code":""},{"path":"/reference/variant_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract per-variant QC data from a Saber object — variant_data","text":"Saber object, tibble/data frame per-variant QC metrics, including collision probabilities related statistics.","code":""},{"path":[]},{"path":"/news/index.html","id":"saber-v9005-6","dir":"Changelog","previous_headings":"","what":"saber v9005-6","title":"saber v9005-6","text":"added multiplexing option parallelized","code":""}]
