% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/saber_crossing.R
\name{cross_sabers}
\alias{cross_sabers}
\title{Cross-link barcoded samples across multiple \code{Saber} objects}
\usage{
cross_sabers(saber_list, n_top = 10L, min_match_score = 5L)
}
\arguments{
\item{saber_list}{A named list of \code{Saber} objects. The names of the
list are used as group identifiers.}

\item{n_top}{Integer scalar; number of top barcodes per sample (per group)
to consider when computing matches. Defaults to \code{10}.}

\item{min_match_score}{Integer scalar; minimum number of shared top
barcodes required to call a match between a sample and a reference
sample. Defaults to \code{5}.}
}
\value{
Invisibly, the function either:
\itemize{
\item raises an error if some samples match more than one reference, or
\item (if integrated into your workflow) yields a tibble of matches as the
last evaluated expression before the consistency check. The tibble
contains \code{group}, \code{sample_name}, \code{true_id} (reference
sample), \code{top_*} columns, and \code{match_score}.
}
}
\description{
Use shared top-\code{n} barcodes to link samples across groups of
\code{Saber} objects, typically representing different experimental runs or
time points from the same set of animals (e.g., zebrafish). The first
element in \code{saber_list} is treated as the reference group, and samples
in subsequent groups are matched to this reference by overlapping top
barcodes.
}
\details{
For each \code{Saber} object, the function:
\enumerate{
\item Extracts the filtered count matrix via \code{\link{barcodes}()}.
\item Uses \code{top_n_rownames_by_column()} to identify the top
\code{n_top} barcodes per sample.
\item Adds a \code{group} column indicating the originating list element.
}
All groups are then combined and passed to \code{rec_name()}, which
recursively matches samples to the first group's samples (reference) using
the number of shared top barcodes as a score. After matching, a check is
performed to ensure that each sample is matched to at most one reference
sample; if this condition is violated, an error is raised suggesting
increasing stringency or improving barcode filtering.
}
\seealso{
\code{\link{Saber}}, \code{\link{barcodes}()}
}
