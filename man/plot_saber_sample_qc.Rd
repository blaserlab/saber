% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/saber_diagnostics.R
\name{plot_saber_sample_qc}
\alias{plot_saber_sample_qc}
\title{Sample-level QC plot for a \code{Saber} object}
\usage{
plot_saber_sample_qc(x)
}
\arguments{
\item{x}{A \code{Saber} object.}
}
\value{
A \code{ggplot} object.
}
\description{
Visualize per-sample quality control metrics, highlighting samples with a
low fraction of reads retained after filtering recurrent and no-variant
barcodes. Outliers are defined as samples whose \code{frac_reads_kept} is
at least 3 median absolute deviations (MADs) below the median.
}
\details{
This function uses the \code{per_sample_qc} slot of \code{x} (via
\code{\link{sample_data}()}) and produces a bar plot of
\code{frac_reads_kept} per sample, ordered by this fraction.

The outlier threshold is computed as:
\deqn{
  T = \mathrm{median}(\mathrm{frac\_reads\_kept}) - 3 \times \mathrm{MAD}(\mathrm{frac\_reads\_kept})
}
using the usual MAD definition. Samples with
\code{frac_reads_kept < T} are highlighted in a different color, and a
horizontal dashed line is drawn at \code{T}.
}
