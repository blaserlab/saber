% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/saber_crossing.R
\name{rec_name}
\alias{rec_name}
\title{Recursive matching of samples across groups based on top-\code{n} barcodes}
\usage{
rec_name(input, group_order, current_idx, n_top, min_match_score)
}
\arguments{
\item{input}{Tibble/data frame containing at least a \code{group} column,
a \code{sample_name} column, and a set of \code{top_*} columns produced by
\code{top_n_rownames_by_column()}.}

\item{n_top}{Integer scalar; number of \code{top_*} columns used (passed
through from \code{cross_sabers()}).}

\item{min_match_score}{Integer scalar; minimum number of shared top barcodes
required to call a match (passed through from \code{cross_sabers()}).}
}
\value{
A tibble of matched samples, with one or more rows per sample
depending on ties, including \code{sample_name}, \code{first_name}
(reference ID), \code{top_*} columns, and \code{match_score}.
}
\description{
Internal helper used by \code{\link{cross_sabers}()} to recursively link
samples across groups by shared top-\code{n} barcodes. The first group in
\code{input$group} is treated as the reference group.
}
\details{
The function:
\enumerate{
\item Identifies the first group in the data as the reference group.
\item Builds a table of reference samples and their \code{top_*} barcodes.
\item Performs a cross join between all samples and reference samples,
computing, for each pair, the number of shared non-\code{NA}
\code{top_*} barcodes (\code{match_score}).
\item For each sample, retains the reference with the maximum
\code{match_score}, and filters matches below \code{min_match_score}.
\item Removes matched samples and recurses on the remaining input until
no unmatched samples remain.
}
}
\keyword{internal}
