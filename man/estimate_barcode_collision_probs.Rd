% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/saber_constructor.R
\name{estimate_barcode_collision_probs}
\alias{estimate_barcode_collision_probs}
\title{Estimate per-variant barcode collision probabilities}
\usage{
estimate_barcode_collision_probs(count_mat, count_thresh, freq_thresh)
}
\arguments{
\item{count_mat}{Numeric matrix of variant counts (rows = variants,
columns = samples).}

\item{count_thresh}{Integer minimum count threshold for presence, used to
construct the presence matrix.}

\item{freq_thresh}{Numeric minimum VAF threshold for presence, used to
construct the presence matrix.}
}
\value{
A tibble with one row per variant containing:
\describe{
\item{variant}{Variant identifier.}
\item{n_samples_present}{Number of samples with the variant present.}
\item{p_sample_present}{Estimated probability a random sample contains
the variant at least once.}
\item{lambda_per_sample}{Estimated Poisson mean per sample.}
\item{P_ge2_per_sample}{Unconditional probability \eqn{P(K \ge 2)}.}
\item{P_ge2_given_present}{Conditional probability \eqn{P(K \ge 2 \mid K \ge 1)}.}
}
}
\description{
Estimate, for each variant, the probability that it arises multiple times
independently in a single sample under a simple Poisson model, using the
observed sharing of that variant across samples.
}
\details{
A logical presence matrix is first constructed using
\code{generate_present_mat()}. For each variant \eqn{i}, the number of
samples in which it is present \eqn{m_i} is used to estimate
\eqn{\hat{p}_i = m_i / S}, where \eqn{S} is the number of samples. Under a
Poisson model for the number of independent origins per sample,
\eqn{K_i \sim \mathrm{Poisson}(\lambda_i)}, we have
\eqn{\hat{p}_i \approx P(K_i \ge 1) = 1 - e^{-\lambda_i}}, so
\eqn{\hat{\lambda}_i = -\log(1 - \hat{p}_i)}. From this,
\code{P_ge2_per_sample} and \code{P_ge2_given_present} are computed.
}
\keyword{internal}
